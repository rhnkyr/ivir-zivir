(function(b){if(typeof b.fn.each2=="undefined"){b.fn.extend({each2:function(c){var h=b([0]),g=-1,a=this.length;while(++g<a&&(h.context=h[0]=this[g])&&c.call(h[0],g,h)!==false){}return this}})}})(jQuery);(function(ae,ac){if(window.Select2!==ac){return}var al,aj,K,L,O,an,U,S;al={TAB:9,ENTER:13,ESC:27,SPACE:32,LEFT:37,UP:38,RIGHT:39,DOWN:40,SHIFT:16,CTRL:17,ALT:18,PAGE_UP:33,PAGE_DOWN:34,HOME:36,END:35,BACKSPACE:8,DELETE:46,isArrow:function(a){a=a.which?a.which:a;switch(a){case al.LEFT:case al.RIGHT:case al.UP:case al.DOWN:return true}return false},isControl:function(a){var b=a.which;switch(b){case al.SHIFT:case al.CTRL:case al.ALT:return true}if(a.metaKey){return true}return false},isFunctionKey:function(a){a=a.which?a.which:a;return a>=112&&a<=123}};S=ae(document);O=(function(){var a=1;return function(){return a++}}());function am(b,a){var c=0,d=a.length;for(;c<d;c=c+1){if(W(b,a[c])){return c}}return -1}function W(a,b){if(a===b){return true}if(a===ac||b===ac){return false}if(a===null||b===null){return false}if(a.constructor===String){return a+""===b+""}if(b.constructor===String){return b+""===a+""}return false}function ab(d,b){var a,c,e;if(d===null||d.length<1){return[]}a=d.split(b);for(c=0,e=a.length;c<e;c=c+1){a[c]=ae.trim(a[c])}return a}function aa(a){return a.outerWidth(false)-a.width()}function V(a){var b="keyup-change-value";a.bind("keydown",function(){if(ae.data(a,b)===ac){ae.data(a,b,a.val())}});a.bind("keyup",function(){var c=ae.data(a,b);if(c!==ac&&a.val()!==c){ae.removeData(a,b);a.trigger("keyup-change")}})}S.bind("mousemove",function(a){U={x:a.pageX,y:a.pageY}});function M(a){a.bind("mousemove",function(b){var c=U;if(c===ac||c.x!==b.pageX||c.y!==b.pageY){ae(b.target).trigger("mousemove-filtered",b)}})}function ah(a,c,d){d=d||ac;var b;return function(){var e=arguments;window.clearTimeout(b);b=window.setTimeout(function(){c.apply(d,e)},a)}}function Q(a){var c=false,b;return function(){if(c===false){b=a();c=true}return b}}function ai(c,a){var b=ah(c,function(d){a.trigger("scroll-debounced",d)});a.bind("scroll",function(d){if(am(d.target,a.get())>=0){b(d)}})}function T(a){if(a[0]===document.activeElement){return}window.setTimeout(function(){var c=a[0],b=a.val().length,d;a.focus();if(a.is(":visible")&&c===document.activeElement){if(c.setSelectionRange){c.setSelectionRange(b,b)}else{if(c.createTextRange){d=c.createTextRange();d.collapse(false);d.select()}}}},0)}function ak(a){a.preventDefault();a.stopPropagation()}function N(a){a.preventDefault();a.stopImmediatePropagation()}function H(a){if(!an){var b=a[0].currentStyle||window.getComputedStyle(a[0],null);an=ae(document.createElement("div")).css({position:"absolute",left:"-10000px",top:"-10000px",display:"none",fontSize:b.fontSize,fontFamily:b.fontFamily,fontStyle:b.fontStyle,fontWeight:b.fontWeight,letterSpacing:b.letterSpacing,textTransform:b.textTransform,whiteSpace:"nowrap"});an.attr("class","select2-sizer");ae("body").append(an)}an.text(a.val());return an.width()}function I(d,f,e){var b,a=[],c;b=d.attr("class");if(b){b=""+b;ae(b.split(" ")).each2(function(){if(this.indexOf("select2-")===0){a.push(this)}})}b=f.attr("class");if(b){b=""+b;ae(b.split(" ")).each2(function(){if(this.indexOf("select2-")!==0){c=e(this);if(c){a.push(this)}}})}d.attr("class",a.join(" "))}function af(f,a,c,e){var b=f.toUpperCase().indexOf(a.toUpperCase()),d=a.length;if(b<0){c.push(e(f));return}c.push(e(f.substring(0,b)));c.push("<span class='select2-match'>");c.push(e(f.substring(b,b+d)));c.push("</span>");c.push(e(f.substring(b+d,f.length)))}function Y(c){var g,d=0,b=null,f=c.quietMillis||100,a=c.url,e=this;return function(h){window.clearTimeout(g);g=window.setTimeout(function(){d+=1;var m=d,k=c.data,n=a,i=c.transport||ae.ajax,l=c.type||"GET",j={};k=k?k.call(e,h.term,h.page,h.context):null;n=(typeof n==="function")?n.call(e,h.term,h.page,h.context):n;if(null!==b){b.abort()}if(c.params){if(ae.isFunction(c.params)){ae.extend(j,c.params.call(e))}else{ae.extend(j,c.params)}}ae.extend(j,{url:n,dataType:c.dataType,data:k,type:l,cache:false,success:function(o){if(m<d){return}var p=c.results(o,h.page);h.callback(p)}});b=i.call(e,j)},f)}}function R(d){var a=d,b,c,f=function(g){return""+g.text};if(ae.isArray(a)){c=a;a={results:c}}if(ae.isFunction(a)===false){c=a;a=function(){return c}}var e=a();if(e.text){f=e.text;if(!ae.isFunction(f)){b=a.text;f=function(g){return g[b]}}}return function(h){var i=h.term,j={results:[]},g;if(i===""){h.callback(a());return}g=function(m,k){var l,n;m=m[0];if(m.children){l={};for(n in m){if(m.hasOwnProperty(n)){l[n]=m[n]}}l.children=[];ae(m.children).each2(function(p,o){g(o,l.children)});if(l.children.length||h.matcher(i,f(l),m)){k.push(l)}}else{if(h.matcher(i,f(m),m)){k.push(m)}}};ae(a().results).each2(function(k,l){g(l,j.results)});h.callback(j)}}function Z(a){var b=ae.isFunction(a);return function(c){var d=c.term,e={results:[]};ae(b?a():a).each(function(){var g=this.text!==ac,f=g?this.text:this;if(d===""||c.matcher(d,f)){e.results.push(g?this:{id:this,text:this})}});c.callback(e)}}function ad(b,a){if(ae.isFunction(b)){return true}if(!b){return false}throw new Error("formatterName must be a function or a falsy value")}function P(a){return ae.isFunction(a)?a():a}function ag(b){var a=0;ae.each(b,function(d,c){if(c.children){a+=ag(c.children)}else{a++}});return a}function X(c,b,e,k){var j=c,a=false,h,d,g,i,f;if(!k.createSearchChoice||!k.tokenSeparators||k.tokenSeparators.length<1){return ac}while(true){d=-1;for(g=0,i=k.tokenSeparators.length;g<i;g++){f=k.tokenSeparators[g];d=c.indexOf(f);if(d>=0){break}}if(d<0){break}h=c.substring(0,d);c=c.substring(d+f.length);if(h.length>0){h=k.createSearchChoice(h,b);if(h!==ac&&h!==null&&k.id(h)!==ac&&k.id(h)!==null){a=false;for(g=0,i=b.length;g<i;g++){if(W(k.id(h),k.id(b[g]))){a=true;break}}if(!a){e(h)}}}}if(j!==c){return c}}function J(c,b){var a=function(){};a.prototype=new c;a.prototype.constructor=a;a.prototype.parent=c.prototype;a.prototype=ae.extend(a.prototype,b);return a}aj=J(Object,{bind:function(a){var b=this;return function(){a.apply(b,arguments)}},init:function(b){var c,d,a=".select2-results",e;this.opts=b=this.prepareOpts(b);this.id=b.id;if(b.element.data("select2")!==ac&&b.element.data("select2")!==null){this.destroy()}this.enabled=true;this.container=this.createContainer();this.containerId="s2id_"+(b.element.attr("id")||"autogen"+O());this.containerSelector="#"+this.containerId.replace(/([;&,\.\+\*\~':"\!\^#$%@\[\]\(\)=>\|])/g,"\\$1");this.container.attr("id",this.containerId);this.body=Q(function(){return b.element.closest("body")});I(this.container,this.opts.element,this.opts.adaptContainerCssClass);this.container.css(P(b.containerCss));this.container.addClass(P(b.containerCssClass));this.elementTabIndex=this.opts.element.attr("tabIndex");this.opts.element.data("select2",this).addClass("select2-offscreen").bind("focus.select2",function(){ae(this).select2("focus")}).attr("tabIndex","-1").before(this.container);this.container.data("select2",this);this.dropdown=this.container.find(".select2-drop");this.dropdown.addClass(P(b.dropdownCssClass));this.dropdown.data("select2",this);this.results=c=this.container.find(a);this.search=d=this.container.find("input.select2-input");d.attr("tabIndex",this.elementTabIndex);this.resultsPage=0;this.context=null;this.initContainer();M(this.results);this.dropdown.delegate(a,"mousemove-filtered touchstart touchmove touchend",this.bind(this.highlightUnderEvent));ai(80,this.results);this.dropdown.delegate(a,"scroll-debounced",this.bind(this.loadMoreIfNeeded));if(ae.fn.mousewheel){c.mousewheel(function(g,f,i,j){var h=c.scrollTop(),k;if(j>0&&h-j<=0){c.scrollTop(0);ak(g)}else{if(j<0&&c.get(0).scrollHeight-c.scrollTop()+j<=c.height()){c.scrollTop(c.get(0).scrollHeight-c.height());ak(g)}}})}V(d);d.bind("keyup-change input paste",this.bind(this.updateResults));d.bind("focus",function(){d.addClass("select2-focused")});d.bind("blur",function(){d.removeClass("select2-focused")});this.dropdown.delegate(a,"mouseup",this.bind(function(f){if(ae(f.target).closest(".select2-result-selectable").length>0){this.highlightUnderEvent(f);this.selectHighlighted(f)}}));this.dropdown.bind("click mouseup mousedown",function(f){f.stopPropagation()});if(ae.isFunction(this.opts.initSelection)){this.initSelection();this.monitorSource()}if(b.element.is(":disabled")||b.element.is("[readonly='readonly']")){this.disable()}},destroy:function(){var a=this.opts.element.data("select2");if(this.propertyObserver){delete this.propertyObserver;this.propertyObserver=null}if(a!==ac){a.container.remove();a.dropdown.remove();a.opts.element.removeClass("select2-offscreen").removeData("select2").unbind(".select2").attr({tabIndex:this.elementTabIndex}).show()}},prepareOpts:function(a){var c,d,e,b;c=a.element;if(c.get(0).tagName.toLowerCase()==="select"){this.select=d=a.element}if(d){ae.each(["id","multiple","ajax","query","createSearchChoice","initSelection","data","tags"],function(){if(this in a){throw new Error("Option '"+this+"' is not allowed for Select2 when attached to a <select> element.")}})}a=ae.extend({},{populateResults:function(n,j,h){var i,k,f,l,m=this.opts.id,g=this;i=function(A,t,o){var z,r,u,x,q,v,s,w,y,p;A=a.sortResults(A,t,h);for(z=0,r=A.length;z<r;z=z+1){u=A[z];q=(u.disabled===true);x=(!q)&&(m(u)!==ac);v=u.children&&u.children.length>0;s=ae("<li></li>");s.addClass("select2-results-dept-"+o);s.addClass("select2-result");s.addClass(x?"select2-result-selectable":"select2-result-unselectable");if(q){s.addClass("select2-disabled")}if(v){s.addClass("select2-result-with-children")}s.addClass(g.opts.formatResultCssClass(u));w=ae(document.createElement("div"));w.addClass("select2-result-label");p=a.formatResult(u,w,h,g.opts.escapeMarkup);if(p!==ac){w.html(p)}s.append(w);if(v){y=ae("<ul></ul>");y.addClass("select2-result-sub");i(u.children,y,o+1);s.append(y)}s.data("select2-data",u);t.append(s)}};i(j,n,0)}},ae.fn.select2.defaults,a);if(typeof(a.id)!=="function"){e=a.id;a.id=function(f){return f[e]}}if(ae.isArray(a.element.data("select2Tags"))){if("tags" in a){throw"tags specified as both an attribute 'data-select2-tags' and in options of Select2 "+a.element.attr("id")}a.tags=a.element.data("select2Tags")}if(d){a.query=this.bind(function(h){var i={results:[],more:false},j=h.term,k,f,g;g=function(n,l){var m;if(n.is("option")){if(h.matcher(j,n.text(),n)){l.push({id:n.attr("value"),text:n.text(),element:n.get(),css:n.attr("class"),disabled:W(n.attr("disabled"),"disabled")})}}else{if(n.is("optgroup")){m={text:n.attr("label"),children:[],element:n.get(),css:n.attr("class")};n.children().each2(function(p,o){g(o,m.children)});if(m.children.length>0){l.push(m)}}}};k=c.children();if(this.getPlaceholder()!==ac&&k.length>0){f=k[0];if(ae(f).text()===""){k=k.not(f)}}k.each2(function(m,l){g(l,i.results)});h.callback(i)});a.id=function(f){return f.id};a.formatResultCssClass=function(f){return f.css}}else{if(!("query" in a)){if("ajax" in a){b=a.element.data("ajax-url");if(b&&b.length>0){a.ajax.url=b}a.query=Y.call(a.element,a.ajax)}else{if("data" in a){a.query=R(a.data)}else{if("tags" in a){a.query=Z(a.tags);if(a.createSearchChoice===ac){a.createSearchChoice=function(f){return{id:f,text:f}}}if(a.initSelection===ac){a.initSelection=function(h,f){var g=[];ae(ab(h.val(),a.separator)).each(function(){var i=this,j=this,k=a.tags;if(ae.isFunction(k)){k=k()}ae(k).each(function(){if(W(this.id,i)){j=this.text;return false}});g.push({id:i,text:j})});f(g)}}}}}}}if(typeof(a.query)!=="function"){throw"query function not defined for Select2 "+a.element.attr("id")}return a},monitorSource:function(){var b=this.opts.element,a;b.bind("change.select2",this.bind(function(c){if(this.opts.element.data("select2-change-triggered")!==true){this.initSelection()}}));a=this.bind(function(){var c,d,e=this;c=this.opts.element.attr("disabled")!=="disabled";d=this.opts.element.attr("readonly")==="readonly";c=c&&!d;if(this.enabled!==c){if(c){this.enable()}else{this.disable()}}I(this.container,this.opts.element,this.opts.adaptContainerCssClass);this.container.addClass(P(this.opts.containerCssClass));I(this.dropdown,this.opts.element,this.opts.adaptDropdownCssClass);this.dropdown.addClass(P(this.opts.dropdownCssClass))});b.bind("propertychange.select2 DOMAttrModified.select2",a);if(typeof WebKitMutationObserver!=="undefined"){if(this.propertyObserver){delete this.propertyObserver;this.propertyObserver=null}this.propertyObserver=new WebKitMutationObserver(function(c){c.forEach(a)});this.propertyObserver.observe(b.get(0),{attributes:true,subtree:false})}},triggerChange:function(a){a=a||{};a=ae.extend({},a,{type:"change",val:this.val()});this.opts.element.data("select2-change-triggered",true);this.opts.element.trigger(a);this.opts.element.data("select2-change-triggered",false);this.opts.element.click();if(this.opts.blurOnChange){this.opts.element.blur()}},enable:function(){if(this.enabled){return}this.enabled=true;this.container.removeClass("select2-container-disabled");this.opts.element.removeAttr("disabled")},disable:function(){if(!this.enabled){return}this.close();this.enabled=false;this.container.addClass("select2-container-disabled");this.opts.element.attr("disabled","disabled")},opened:function(){return this.container.hasClass("select2-dropdown-open")},positionDropdown:function(){var j=this.container.offset(),a=this.container.outerHeight(false),o=this.container.outerWidth(false),k=this.dropdown.outerHeight(false),h=ae(window).scrollLeft()+ae(window).width(),e=ae(window).scrollTop()+ae(window).height(),p=j.top+a,b=j.left,d=p+k<=e,f=(j.top-k)>=this.body().scrollTop(),n=this.dropdown.outerWidth(false),m=b+n<=h,l=this.dropdown.hasClass("select2-drop-above"),i,c,g;if(this.body().css("position")!=="static"){i=this.body().offset();p-=i.top;b-=i.left}if(l){c=true;if(!f&&d){c=false}}else{c=false;if(!d&&f){c=true}}if(!m){b=j.left+o-n}if(c){p=j.top-k;this.container.addClass("select2-drop-above");this.dropdown.addClass("select2-drop-above")}else{this.container.removeClass("select2-drop-above");this.dropdown.removeClass("select2-drop-above")}g=ae.extend({top:p,left:b,width:o},P(this.opts.dropdownCss));this.dropdown.css(g)},shouldOpen:function(){var a;if(this.opened()){return false}a=ae.Event("opening");this.opts.element.trigger(a);return !a.isDefaultPrevented()},clearDropdownAlignmentPreference:function(){this.container.removeClass("select2-drop-above");this.dropdown.removeClass("select2-drop-above")},open:function(){if(!this.shouldOpen()){return false}window.setTimeout(this.bind(this.opening),1);return true},opening:function(){var f=this.containerId,e="scroll."+f,a="resize."+f,b="orientationchange."+f,d;this.clearDropdownAlignmentPreference();this.container.addClass("select2-dropdown-open").addClass("select2-container-active");if(this.dropdown[0]!==this.body().children().last()[0]){this.dropdown.detach().appendTo(this.body())}this.updateResults(true);d=ae("#select2-drop-mask");if(d.length==0){d=ae(document.createElement("div"));d.attr("id","select2-drop-mask").attr("class","select2-drop-mask");d.hide();d.appendTo(this.body());d.bind("mousedown touchstart",function(i){var h=ae("#select2-drop"),j;if(h.length>0){j=h.data("select2");if(j.opts.selectOnBlur){j.selectHighlighted({noFocus:true})}j.close()}})}if(this.dropdown.prev()[0]!==d[0]){this.dropdown.before(d)}ae("#select2-drop").removeAttr("id");this.dropdown.attr("id","select2-drop");d.css(c());d.show();this.dropdown.show();this.positionDropdown();this.dropdown.addClass("select2-drop-active");this.ensureHighlightVisible();var g=this;this.container.parents().add(window).each(function(){ae(this).bind(a+" "+e+" "+b,function(h){ae("#select2-drop-mask").css(c());g.positionDropdown()})});this.focusSearch();function c(){return{width:Math.max(document.documentElement.scrollWidth,ae(window).width()),height:Math.max(document.documentElement.scrollHeight,ae(window).height())}}},close:function(){if(!this.opened()){return}var a=this.containerId,d="scroll."+a,b="resize."+a,c="orientationchange."+a;this.container.parents().add(window).each(function(){ae(this).unbind(d).unbind(b).unbind(c)});this.clearDropdownAlignmentPreference();ae("#select2-drop-mask").hide();this.dropdown.removeAttr("id");this.dropdown.hide();this.container.removeClass("select2-dropdown-open");this.results.empty();this.clearSearch();this.search.removeClass("select2-active");this.opts.element.trigger(ae.Event("close"))},clearSearch:function(){},getMaximumSelectionSize:function(){return P(this.opts.maximumSelectionSize)},ensureHighlightVisible:function(){var b=this.results,c,e,f,g,a,h,d;e=this.highlight();if(e<0){return}if(e==0){b.scrollTop(0);return}c=this.findHighlightableChoices();f=ae(c[e]);g=f.offset().top+f.outerHeight(true);if(e===c.length-1){d=b.find("li.select2-more-results");if(d.length>0){g=d.offset().top+d.outerHeight(true)}}a=b.offset().top+b.outerHeight(true);if(g>a){b.scrollTop(b.scrollTop()+(g-a))}h=f.offset().top-b.offset().top;if(h<0&&f.css("display")!="none"){b.scrollTop(b.scrollTop()+h)}},findHighlightableChoices:function(){var a=this.results.find(".select2-result-selectable:not(.select2-selected):not(.select2-disabled)");return this.results.find(".select2-result-selectable:not(.select2-selected):not(.select2-disabled)")},moveHighlight:function(a){var b=this.findHighlightableChoices(),c=this.highlight();while(c>-1&&c<b.length){c+=a;var d=ae(b[c]);if(d.hasClass("select2-result-selectable")&&!d.hasClass("select2-disabled")&&!d.hasClass("select2-selected")){this.highlight(c);break}}},highlight:function(c){var a=this.findHighlightableChoices(),d,b;if(arguments.length===0){return am(a.filter(".select2-highlighted")[0],a.get())}if(c>=a.length){c=a.length-1}if(c<0){c=0}this.results.find(".select2-highlighted").removeClass("select2-highlighted");d=ae(a[c]);d.addClass("select2-highlighted");this.ensureHighlightVisible();b=d.data("select2-data");if(b){this.opts.element.trigger({type:"highlight",val:this.id(b),choice:b})}},countSelectableResults:function(){return this.findHighlightableChoices().length},highlightUnderEvent:function(b){var c=ae(b.target).closest(".select2-result-selectable");if(c.length>0&&!c.is(".select2-highlighted")){var a=this.findHighlightableChoices();this.highlight(a.index(c))}else{if(c.length==0){this.results.find(".select2-highlighted").removeClass("select2-highlighted")}}},loadMoreIfNeeded:function(){var a=this.results,b=a.find("li.select2-more-results"),f,g=-1,h=this.resultsPage+1,e=this,c=this.search.val(),d=this.context;if(b.length===0){return}f=b.offset().top-a.offset().top-a.height();if(f<=this.opts.loadMorePadding){b.addClass("select2-active");this.opts.query({element:this.opts.element,term:c,page:h,context:d,matcher:this.opts.matcher,callback:this.bind(function(i){if(!e.opened()){return}e.opts.populateResults.call(this,a,i.results,{term:c,page:h,context:d});e.postprocessResults(i,false,false);if(i.more===true){b.detach().appendTo(a).text(e.opts.formatLoadMore(h+1));window.setTimeout(function(){e.loadMoreIfNeeded()},10)}else{b.remove()}e.positionDropdown();e.resultsPage=h;e.context=i.context})})}},tokenize:function(){},updateResults:function(d){var a=this.search,f=this.results,l=this.opts,g,b=this,c,h=a.val(),j=ae.data(this.container,"select2-last-term");if(d!==true&&j&&W(h,j)){return}ae.data(this.container,"select2-last-term",h);if(d!==true&&(this.showSearchInput===false||!this.opened())){return}function e(){f.scrollTop(0);a.removeClass("select2-active");b.positionDropdown()}function k(m){f.html(m);e()}var i=this.getMaximumSelectionSize();if(i>=1){g=this.data();if(ae.isArray(g)&&g.length>=i&&ad(l.formatSelectionTooBig,"formatSelectionTooBig")){k("<li class='select2-selection-limit'>"+l.formatSelectionTooBig(i)+"</li>");return}}if(a.val().length<l.minimumInputLength){if(ad(l.formatInputTooShort,"formatInputTooShort")){k("<li class='select2-no-results'>"+l.formatInputTooShort(a.val(),l.minimumInputLength)+"</li>")}else{k("")}return}if(l.maximumInputLength&&a.val().length>l.maximumInputLength){if(ad(l.formatInputTooLong,"formatInputTooLong")){k("<li class='select2-no-results'>"+l.formatInputTooLong(a.val(),l.maximumInputLength)+"</li>")}else{k("")}return}if(l.formatSearching&&this.findHighlightableChoices().length===0){k("<li class='select2-searching'>"+l.formatSearching()+"</li>")}a.addClass("select2-active");c=this.tokenize();if(c!=ac&&c!=null){a.val(c)}this.resultsPage=1;l.query({element:l.element,term:a.val(),page:this.resultsPage,context:null,matcher:l.matcher,callback:this.bind(function(m){var n;if(!this.opened()){this.search.removeClass("select2-active");return}this.context=(m.context===ac)?null:m.context;if(this.opts.createSearchChoice&&a.val()!==""){n=this.opts.createSearchChoice.call(null,a.val(),m.results);if(n!==ac&&n!==null&&b.id(n)!==ac&&b.id(n)!==null){if(ae(m.results).filter(function(){return W(b.id(this),b.id(n))}).length===0){m.results.unshift(n)}}}if(m.results.length===0&&ad(l.formatNoMatches,"formatNoMatches")){k("<li class='select2-no-results'>"+l.formatNoMatches(a.val())+"</li>");return}f.empty();b.opts.populateResults.call(this,f,m.results,{term:a.val(),page:this.resultsPage,context:null});if(m.more===true&&ad(l.formatLoadMore,"formatLoadMore")){f.append("<li class='select2-more-results'>"+b.opts.escapeMarkup(l.formatLoadMore(this.resultsPage))+"</li>");window.setTimeout(function(){b.loadMoreIfNeeded()},10)}this.postprocessResults(m,d);e();this.opts.element.trigger({type:"loaded",data:m})})})},cancel:function(){this.close()},blur:function(){if(this.opts.selectOnBlur){this.selectHighlighted({noFocus:true})}this.close();this.container.removeClass("select2-container-active");if(this.search[0]===document.activeElement){this.search.blur()}this.clearSearch();this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus")},focusSearch:function(){T(this.search)},selectHighlighted:function(c){var d=this.highlight(),b=this.results.find(".select2-highlighted"),a=b.closest(".select2-result").data("select2-data");if(a){this.highlight(d);this.onSelect(a,c)}},getPlaceholder:function(){return this.opts.element.attr("placeholder")||this.opts.element.attr("data-placeholder")||this.opts.element.data("placeholder")||this.opts.placeholder},initContainerWidth:function(){function a(){var g,d,f,c,e;if(this.opts.width==="off"){return null}else{if(this.opts.width==="element"){return this.opts.element.outerWidth(false)===0?"auto":this.opts.element.outerWidth(false)+"px"}else{if(this.opts.width==="copy"||this.opts.width==="resolve"){g=this.opts.element.attr("style");if(g!==ac){d=g.split(";");for(c=0,e=d.length;c<e;c=c+1){f=d[c].replace(/\s/g,"").match(/width:(([-+]?([0-9]*\.)?[0-9]+)(px|em|ex|%|in|cm|mm|pt|pc))/);if(f!==null&&f.length>=1){return f[1]}}}if(this.opts.width==="resolve"){g=this.opts.element.css("width");if(g.indexOf("%")>0){return g}return(this.opts.element.outerWidth(false)===0?"auto":this.opts.element.outerWidth(false)+"px")}return null}else{if(ae.isFunction(this.opts.width)){return this.opts.width()}else{return this.opts.width}}}}}var b=a.call(this);if(b!==null){this.container.css("width",b)}}});K=J(aj,{createContainer:function(){var a=ae(document.createElement("div")).attr({"class":"select2-container"}).html(["<a href='javascript:void(0)' onclick='return false;' class='select2-choice' tabindex='-1'>","   <span></span><abbr class='select2-search-choice-close' style='display:none;'></abbr>","   <div><b></b></div>","</a>","<input class='select2-focusser select2-offscreen' type='text'/>","<div class='select2-drop' style='display:none'>","   <div class='select2-search'>","       <input type='text' autocomplete='off' class='select2-input'/>","   </div>","   <ul class='select2-results'>","   </ul>","</div>"].join(""));return a},disable:function(){if(!this.enabled){return}this.parent.disable.apply(this,arguments);this.focusser.attr("disabled","disabled")},enable:function(){if(this.enabled){return}this.parent.enable.apply(this,arguments);this.focusser.removeAttr("disabled")},opening:function(){this.parent.opening.apply(this,arguments);this.focusser.attr("disabled","disabled");this.opts.element.trigger(ae.Event("open"))},close:function(){if(!this.opened()){return}this.parent.close.apply(this,arguments);this.focusser.removeAttr("disabled");T(this.focusser)},focus:function(){if(this.opened()){this.close()}else{this.focusser.removeAttr("disabled");this.focusser.focus()}},isFocused:function(){return this.container.hasClass("select2-container-active")},cancel:function(){this.parent.cancel.apply(this,arguments);this.focusser.removeAttr("disabled");this.focusser.focus()},initContainer:function(){var b,c=this.container,a=this.dropdown,d=false;this.showSearch(this.opts.minimumResultsForSearch>=0);this.selection=b=c.find(".select2-choice");this.focusser=c.find(".select2-focusser");this.focusser.attr("id","s2id_autogen"+O());ae("label[for='"+this.opts.element.attr("id")+"']").attr("for",this.focusser.attr("id"));this.search.bind("keydown",this.bind(function(e){if(!this.enabled){return}if(e.which===al.PAGE_UP||e.which===al.PAGE_DOWN){ak(e);return}switch(e.which){case al.UP:case al.DOWN:this.moveHighlight((e.which===al.UP)?-1:1);ak(e);return;case al.TAB:case al.ENTER:this.selectHighlighted();ak(e);return;case al.ESC:this.cancel(e);ak(e);return}}));this.search.bind("blur",this.bind(function(e){if(document.activeElement===this.body().get(0)){window.setTimeout(this.bind(function(){this.search.focus()}),0)}}));this.focusser.bind("keydown",this.bind(function(e){if(!this.enabled){return}if(e.which===al.TAB||al.isControl(e)||al.isFunctionKey(e)||e.which===al.ESC){return}if(this.opts.openOnEnter===false&&e.which===al.ENTER){ak(e);return}if(e.which==al.DOWN||e.which==al.UP||(e.which==al.ENTER&&this.opts.openOnEnter)){this.open();ak(e);return}if(e.which==al.DELETE||e.which==al.BACKSPACE){if(this.opts.allowClear){this.clear()}ak(e);return}}));V(this.focusser);this.focusser.bind("keyup-change input",this.bind(function(e){if(this.opened()){return}this.open();if(this.showSearchInput!==false){this.search.val(this.focusser.val())}this.focusser.val("");ak(e)}));b.delegate("abbr","mousedown",this.bind(function(e){if(!this.enabled){return}this.clear();N(e);this.close();this.selection.focus()}));b.bind("mousedown",this.bind(function(e){d=true;if(this.opened()){this.close()}else{if(this.enabled){this.open()}}ak(e);d=false}));a.bind("mousedown",this.bind(function(){this.search.focus()}));b.bind("focus",this.bind(function(e){ak(e)}));this.focusser.bind("focus",this.bind(function(){this.container.addClass("select2-container-active")})).bind("blur",this.bind(function(){if(!this.opened()){this.container.removeClass("select2-container-active")}}));this.search.bind("focus",this.bind(function(){this.container.addClass("select2-container-active")}));this.initContainerWidth();this.setPlaceholder()},clear:function(b){var a=this.selection.data("select2-data");if(a){this.opts.element.val("");this.selection.find("span").empty();this.selection.removeData("select2-data");this.setPlaceholder();if(b!==false){this.opts.element.trigger({type:"removed",val:this.id(a),choice:a});this.triggerChange({removed:a})}}},initSelection:function(){var a;if(this.opts.element.val()===""&&this.opts.element.text()===""){this.close();this.setPlaceholder()}else{var b=this;this.opts.initSelection.call(null,this.opts.element,function(c){if(c!==ac&&c!==null){b.updateSelection(c);b.close();b.setPlaceholder()}})}},prepareOpts:function(){var a=this.parent.prepareOpts.apply(this,arguments);if(a.element.get(0).tagName.toLowerCase()==="select"){a.initSelection=function(d,b){var c=d.find(":selected");if(ae.isFunction(b)){b({id:c.attr("value"),text:c.text(),element:c})}}}else{if("data" in a){a.initSelection=a.initSelection||function(d,b){var c=d.val();var e=null;a.query({matcher:function(i,f,h){var g=W(c,a.id(h));if(g){e=h}return g},callback:!ae.isFunction(b)?ae.noop:function(){b(e)}})}}}return a},getPlaceholder:function(){if(this.select){if(this.select.find("option").first().text()!==""){return ac}}return this.parent.getPlaceholder.apply(this,arguments)},setPlaceholder:function(){var a=this.getPlaceholder();if(this.opts.element.val()===""&&a!==ac){if(this.select&&this.select.find("option:first").text()!==""){return}this.selection.find("span").html(this.opts.escapeMarkup(a));this.selection.addClass("select2-default");this.selection.find("abbr").hide()}},postprocessResults:function(g,d,a){var b=0,e=this,f=true;this.findHighlightableChoices().each2(function(i,h){if(W(e.id(h.data("select2-data")),e.opts.element.val())){b=i;return false}});if(a!==false){this.highlight(b)}if(d===true){var c=this.opts.minimumResultsForSearch;f=c<0?false:ag(g.results)>=c;this.showSearch(f)}},showSearch:function(a){this.showSearchInput=a;this.dropdown.find(".select2-search")[a?"removeClass":"addClass"]("select2-search-hidden");ae(this.dropdown,this.container)[a?"addClass":"removeClass"]("select2-with-searchbox")},onSelect:function(a,b){var c=this.opts.element.val();this.opts.element.val(this.id(a));this.updateSelection(a);this.opts.element.trigger({type:"selected",val:this.id(a),choice:a});this.close();if(!b||!b.noFocus){this.selection.focus()}if(!W(c,this.id(a))){this.triggerChange()}},updateSelection:function(a){var c=this.selection.find("span"),b;this.selection.data("select2-data",a);c.empty();b=this.opts.formatSelection(a,c);if(b!==ac){c.append(this.opts.escapeMarkup(b))}this.selection.removeClass("select2-default");if(this.opts.allowClear&&this.getPlaceholder()!==ac){this.selection.find("abbr").show()}},val:function(){var a,c=false,b=null,d=this;if(arguments.length===0){return this.opts.element.val()}a=arguments[0];if(arguments.length>1){c=arguments[1]}if(this.select){this.select.val(a).find(":selected").each2(function(e,f){b={id:f.attr("value"),text:f.text(),element:f.get(0)};return false});this.updateSelection(b);this.setPlaceholder();if(c){this.triggerChange()}}else{if(this.opts.initSelection===ac){throw new Error("cannot call val() if initSelection() is not defined")}if(!a&&a!==0){this.clear(c);if(c){this.triggerChange()}return}this.opts.element.val(a);this.opts.initSelection(this.opts.element,function(e){d.opts.element.val(!e?"":d.id(e));d.updateSelection(e);d.setPlaceholder();if(c){d.triggerChange()}})}},clearSearch:function(){this.search.val("");this.focusser.val("")},data:function(a){var b;if(arguments.length===0){b=this.selection.data("select2-data");if(b==ac){b=null}return b}else{if(!a||a===""){this.clear()}else{this.opts.element.val(!a?"":this.id(a));this.updateSelection(a)}}}});L=J(aj,{createContainer:function(){var a=ae(document.createElement("div")).attr({"class":"select2-container select2-container-multi"}).html(["    <ul class='select2-choices'>","  <li class='select2-search-field'>","    <input type='text' autocomplete='off' class='select2-input'>","  </li>","</ul>","<div class='select2-drop select2-drop-multi' style='display:none;'>","   <ul class='select2-results'>","   </ul>","</div>"].join(""));return a},prepareOpts:function(){var a=this.parent.prepareOpts.apply(this,arguments);if(a.element.get(0).tagName.toLowerCase()==="select"){a.initSelection=function(d,b){var c=[];d.find(":selected").each2(function(e,f){c.push({id:f.attr("value"),text:f.text(),element:f[0]})});b(c)}}else{if("data" in a){a.initSelection=a.initSelection||function(e,b){var d=ab(e.val(),a.separator);var c=[];a.query({matcher:function(i,f,h){var g=ae.grep(d,function(j){return W(j,a.id(h))}).length;if(g){c.push(h)}return g},callback:!ae.isFunction(b)?ae.noop:function(){b(c)}})}}}return a},initContainer:function(){var b=".select2-choices",a;this.searchContainer=this.container.find(".select2-search-field");this.selection=a=this.container.find(b);this.search.attr("id","s2id_autogen"+O());ae("label[for='"+this.opts.element.attr("id")+"']").attr("for",this.search.attr("id"));this.search.bind("input paste",this.bind(function(){if(!this.enabled){return}if(!this.opened()){this.open()}}));this.search.bind("keydown",this.bind(function(d){if(!this.enabled){return}if(d.which===al.BACKSPACE&&this.search.val()===""){this.close();var c,e=a.find(".select2-search-choice-focus");if(e.length>0){this.unselect(e.first());this.search.width(10);ak(d);return}c=a.find(".select2-search-choice:not(.select2-locked)");if(c.length>0){c.last().addClass("select2-search-choice-focus")}}else{a.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus")}if(this.opened()){switch(d.which){case al.UP:case al.DOWN:this.moveHighlight((d.which===al.UP)?-1:1);ak(d);return;case al.ENTER:case al.TAB:this.selectHighlighted();ak(d);return;case al.ESC:this.cancel(d);ak(d);return}}if(d.which===al.TAB||al.isControl(d)||al.isFunctionKey(d)||d.which===al.BACKSPACE||d.which===al.ESC){return}if(d.which===al.ENTER){if(this.opts.openOnEnter===false){return}else{if(d.altKey||d.ctrlKey||d.shiftKey||d.metaKey){return}}}this.open();if(d.which===al.PAGE_UP||d.which===al.PAGE_DOWN){ak(d)}if(d.which===al.ENTER){ak(d)}}));this.search.bind("keyup",this.bind(this.resizeSearch));this.search.bind("blur",this.bind(function(c){this.container.removeClass("select2-container-active");this.search.removeClass("select2-focused");if(!this.opened()){this.clearSearch()}c.stopImmediatePropagation()}));this.container.delegate(b,"mousedown",this.bind(function(c){if(!this.enabled){return}if(ae(c.target).closest(".select2-search-choice").length>0){return}this.clearPlaceholder();this.open();this.focusSearch();c.preventDefault()}));this.container.delegate(b,"focus",this.bind(function(){if(!this.enabled){return}this.container.addClass("select2-container-active");this.dropdown.addClass("select2-drop-active");this.clearPlaceholder()}));this.initContainerWidth();this.clearSearch()},enable:function(){if(this.enabled){return}this.parent.enable.apply(this,arguments);this.search.removeAttr("disabled")},disable:function(){if(!this.enabled){return}this.parent.disable.apply(this,arguments);this.search.attr("disabled",true)},initSelection:function(){var a;if(this.opts.element.val()===""&&this.opts.element.text()===""){this.updateSelection([]);this.close();this.clearSearch()}if(this.select||this.opts.element.val()!==""){var b=this;this.opts.initSelection.call(null,this.opts.element,function(c){if(c!==ac&&c!==null){b.updateSelection(c);b.close();b.clearSearch()}})}},clearSearch:function(){var a=this.getPlaceholder();if(a!==ac&&this.getVal().length===0&&this.search.hasClass("select2-focused")===false){this.search.val(a).addClass("select2-default");this.search.width(this.getMaxSearchWidth())}else{this.search.val("").width(10)}},clearPlaceholder:function(){if(this.search.hasClass("select2-default")){this.search.val("").removeClass("select2-default")}},opening:function(){this.clearPlaceholder();this.resizeSearch();this.parent.opening.apply(this,arguments);this.focusSearch();this.opts.element.trigger(ae.Event("open"))},close:function(){if(!this.opened()){return}this.parent.close.apply(this,arguments)},focus:function(){this.close();this.search.focus()},isFocused:function(){return this.search.hasClass("select2-focused")},updateSelection:function(a){var b=[],c=[],d=this;ae(a).each(function(){if(am(d.id(this),b)<0){b.push(d.id(this));c.push(this)}});a=c;this.selection.find(".select2-search-choice").remove();ae(a).each(function(){d.addSelectedChoice(this)});d.postprocessResults()},tokenize:function(){var a=this.search.val();a=this.opts.tokenizer(a,this.data(),this.bind(this.onSelect),this.opts);if(a!=null&&a!=ac){this.search.val(a);if(a.length>0){this.open()}}},onSelect:function(a,b){this.addSelectedChoice(a);this.opts.element.trigger({type:"selected",val:this.id(a),choice:a});if(this.select||!this.opts.closeOnSelect){this.postprocessResults()}if(this.opts.closeOnSelect){this.close();this.search.width(10)}else{if(this.countSelectableResults()>0){this.search.width(10);this.resizeSearch();if(this.getMaximumSelectionSize()>0&&this.val().length>=this.getMaximumSelectionSize()){this.updateResults(true)}this.positionDropdown()}else{this.close();this.search.width(10)}}this.triggerChange({added:a});if(!b||!b.noFocus){this.focusSearch()}},cancel:function(){this.close();this.focusSearch()},addSelectedChoice:function(b){var d=!b.locked,f=ae("<li class='select2-search-choice'>    <div></div>    <a href='#' onclick='return false;' class='select2-search-choice-close' tabindex='-1'></a></li>"),g=ae("<li class='select2-search-choice select2-locked'><div></div></li>");var e=d?f:g,h=this.id(b),a=this.getVal(),c;c=this.opts.formatSelection(b,e.find("div"));if(c!=ac){e.find("div").replaceWith("<div>"+this.opts.escapeMarkup(c)+"</div>")}if(d){e.find(".select2-search-choice-close").bind("mousedown",ak).bind("click dblclick",this.bind(function(i){if(!this.enabled){return}ae(i.target).closest(".select2-search-choice").fadeOut("fast",this.bind(function(){this.unselect(ae(i.target));this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus");this.close();this.focusSearch()})).dequeue();ak(i)})).bind("focus",this.bind(function(){if(!this.enabled){return}this.container.addClass("select2-container-active");this.dropdown.addClass("select2-drop-active")}))}e.data("select2-data",b);e.insertBefore(this.searchContainer);a.push(h);this.setVal(a)},unselect:function(c){var a=this.getVal(),b,d;c=c.closest(".select2-search-choice");if(c.length===0){throw"Invalid argument: "+c+". Must be .select2-search-choice"}b=c.data("select2-data");if(!b){return}d=am(this.id(b),a);if(d>=0){a.splice(d,1);this.setVal(a);if(this.select){this.postprocessResults()}}c.remove();this.opts.element.trigger({type:"removed",val:this.id(b),choice:b});this.triggerChange({removed:b})},postprocessResults:function(){var b=this.getVal(),a=this.results.find(".select2-result"),c=this.results.find(".select2-result-with-children"),d=this;a.each2(function(g,e){var f=d.id(e.data("select2-data"));if(am(f,b)>=0){e.addClass("select2-selected");e.find(".select2-result-selectable").addClass("select2-selected")}});c.each2(function(f,e){if(!e.is(".select2-result-selectable")&&e.find(".select2-result-selectable:not(.select2-selected)").length===0){e.addClass("select2-selected")}});if(this.highlight()==-1){d.highlight(0)}},getMaxSearchWidth:function(){return this.selection.width()-aa(this.search)},resizeSearch:function(){var f,b,c,e,d,a=aa(this.search);f=H(this.search)+10;b=this.search.offset().left;c=this.selection.width();e=this.selection.offset().left;d=c-(b-e)-a;if(d<f){d=c-a}if(d<40){d=c-a}if(d<=0){d=f}this.search.width(d)},getVal:function(){var a;if(this.select){a=this.select.val();return a===null?[]:a}else{a=this.opts.element.val();return ab(a,this.opts.separator)}},setVal:function(a){var b;if(this.select){this.select.val(a)}else{b=[];ae(a).each(function(){if(am(this,b)<0){b.push(this)}});this.opts.element.val(b.length===0?"":b.join(this.opts.separator))}},val:function(){var a,c=false,b=[],d=this;if(arguments.length===0){return this.getVal()}a=arguments[0];if(arguments.length>1){c=arguments[1]}if(!a&&a!==0){this.opts.element.val("");this.updateSelection([]);this.clearSearch();if(c){this.triggerChange()}return}this.setVal(a);if(this.select){this.opts.initSelection(this.select,this.bind(this.updateSelection));if(c){this.triggerChange()}}else{if(this.opts.initSelection===ac){throw new Error("val() cannot be called if initSelection() is not defined")}this.opts.initSelection(this.opts.element,function(f){var e=ae(f).map(d.id);d.setVal(e);d.updateSelection(f);d.clearSearch();if(c){d.triggerChange()}})}this.clearSearch()},onSortStart:function(){if(this.select){throw new Error("Sorting of elements is not supported when attached to <select>. Attach to <input type='hidden'/> instead.")}this.search.width(0);this.searchContainer.hide()},onSortEnd:function(){var a=[],b=this;this.searchContainer.show();this.searchContainer.appendTo(this.searchContainer.parent());this.resizeSearch();this.selection.find(".select2-search-choice").each(function(){a.push(b.opts.id(ae(this).data("select2-data")))});this.setVal(a);this.triggerChange()},data:function(b){var c=this,a;if(arguments.length===0){return this.selection.find(".select2-search-choice").map(function(){return ae(this).data("select2-data")}).get()}else{if(!b){b=[]}a=ae.map(b,function(d){return c.opts.id(d)});this.setVal(a);this.updateSelection(b);this.clearSearch()}}});ae.fn.select2=function(){var b=Array.prototype.slice.call(arguments,0),a,c,f,d,e=["val","destroy","opened","open","close","focus","isFocused","container","onSortStart","onSortEnd","enable","disable","positionDropdown","data"];this.each(function(){if(b.length===0||typeof(b[0])==="object"){a=b.length===0?{}:ae.extend({},b[0]);a.element=ae(this);if(a.element.get(0).tagName.toLowerCase()==="select"){d=a.element.attr("multiple")}else{d=a.multiple||false;if("tags" in a){a.multiple=d=true}}c=d?new L():new K();c.init(a)}else{if(typeof(b[0])==="string"){if(am(b[0],e)<0){throw"Unknown method: "+b[0]}f=ac;c=ae(this).data("select2");if(c===ac){return}if(b[0]==="container"){f=c.container}else{f=c[b[0]].apply(c,b.slice(1))}if(f!==ac){return false}}else{throw"Invalid arguments to select2 plugin: "+b}}});return(f===ac)?this:f};ae.fn.select2.defaults={width:"copy",loadMorePadding:0,closeOnSelect:true,openOnEnter:true,containerCss:{},dropdownCss:{},containerCssClass:"",dropdownCssClass:"",formatResult:function(d,c,a,e){var b=[];af(d.text,a.term,b,e);return b.join("")},formatSelection:function(a,b){return a?a.text:ac},sortResults:function(b,c,a){return b},formatResultCssClass:function(a){return ac},formatNoMatches:function(){return"No matches found"},formatInputTooShort:function(c,b){var a=b-c.length;return"Please enter "+a+" more character"+(a==1?"":"s")},formatInputTooLong:function(b,c){var a=b.length-c;return"Please delete "+a+" character"+(a==1?"":"s")},formatSelectionTooBig:function(a){return"You can only select "+a+" item"+(a==1?"":"s")},formatLoadMore:function(a){return"Loading more results..."},formatSearching:function(){return"Searching..."},minimumResultsForSearch:0,minimumInputLength:0,maximumInputLength:null,maximumSelectionSize:0,id:function(a){return a.id},matcher:function(b,a){return(""+a).toUpperCase().indexOf((""+b).toUpperCase())>=0},separator:",",tokenSeparators:[],tokenizer:X,escapeMarkup:function(b){var a={"\\":"&#92;","&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&apos;","/":"&#47;"};return String(b).replace(/[&<>"'\/\\]/g,function(c){return a[c[0]]})},blurOnChange:false,selectOnBlur:false,adaptContainerCssClass:function(a){return a},adaptDropdownCssClass:function(a){return null}};window.Select2={query:{ajax:Y,local:R,tags:Z},util:{debounce:ah,markMatch:af},"class":{"abstract":aj,single:K,multi:L}}}(jQuery));