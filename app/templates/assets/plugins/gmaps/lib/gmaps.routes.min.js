var travelMode,unitSystem;GMaps.prototype.getRoutes=function(f){switch(f.travelMode){case"bicycling":travelMode=google.maps.TravelMode.BICYCLING;break;case"transit":travelMode=google.maps.TravelMode.TRANSIT;break;case"driving":travelMode=google.maps.TravelMode.DRIVING;break;default:travelMode=google.maps.TravelMode.WALKING;break}if(f.unitSystem==="imperial"){unitSystem=google.maps.UnitSystem.IMPERIAL}else{unitSystem=google.maps.UnitSystem.METRIC}var d={avoidHighways:false,avoidTolls:false,optimizeWaypoints:false,waypoints:[]},c=extend_object(d,f);c.origin=/string/.test(typeof f.origin)?f.origin:new google.maps.LatLng(f.origin[0],f.origin[1]);c.destination=/string/.test(typeof f.destination)?f.destination:new google.maps.LatLng(f.destination[0],f.destination[1]);c.travelMode=travelMode;c.unitSystem=unitSystem;delete c.callback;var b=this,a=new google.maps.DirectionsService();a.route(c,function(g,h){if(h===google.maps.DirectionsStatus.OK){for(var i in g.routes){if(g.routes.hasOwnProperty(i)){b.routes.push(g.routes[i])}}}if(f.callback){f.callback(b.routes)}})};GMaps.prototype.removeRoutes=function(){this.routes=[]};GMaps.prototype.getElevations=function(b){b=extend_object({locations:[],path:false,samples:256},b);if(b.locations.length>0){if(b.locations[0].length>0){b.locations=array_flat(array_map([b.locations],arrayToLatLng,false))}}var d=b.callback;delete b.callback;var a=new google.maps.ElevationService();if(!b.path){delete b.path;delete b.samples;a.getElevationForLocations(b,function(f,g){if(d&&typeof(d)==="function"){d(f,g)}})}else{var c={path:b.locations,samples:b.samples};a.getElevationAlongPath(c,function(f,g){if(d&&typeof(d)==="function"){d(f,g)}})}};GMaps.prototype.cleanRoute=GMaps.prototype.removePolylines;GMaps.prototype.drawRoute=function(b){var a=this;this.getRoutes({origin:b.origin,destination:b.destination,travelMode:b.travelMode,waypoints:b.waypoints,unitSystem:b.unitSystem,callback:function(c){if(c.length>0){a.drawPolyline({path:c[c.length-1].overview_path,strokeColor:b.strokeColor,strokeOpacity:b.strokeOpacity,strokeWeight:b.strokeWeight});if(b.callback){b.callback(c[c.length-1])}}}})};GMaps.prototype.travelRoute=function(b){if(b.origin&&b.destination){this.getRoutes({origin:b.origin,destination:b.destination,travelMode:b.travelMode,waypoints:b.waypoints,callback:function(k){if(k.length>0&&b.start){b.start(k[k.length-1])}if(k.length>0&&b.step){var g=k[k.length-1];if(g.legs.length>0){var f=g.legs[0].steps;for(var h=0,j;j=f[h];h++){j.step_number=h;b.step(j,(g.legs[0].steps.length-1))}}}if(k.length>0&&b.end){b.end(k[k.length-1])}}})}else{if(b.route){if(b.route.legs.length>0){var a=b.route.legs[0].steps;for(var c=0,d;d=a[c];c++){d.step_number=c;b.step(d)}}}}};GMaps.prototype.drawSteppedRoute=function(c){var b=this;if(c.origin&&c.destination){this.getRoutes({origin:c.origin,destination:c.destination,travelMode:c.travelMode,waypoints:c.waypoints,callback:function(l){if(l.length>0&&c.start){c.start(l[l.length-1])}if(l.length>0&&c.step){var h=l[l.length-1];if(h.legs.length>0){var g=h.legs[0].steps;for(var j=0,k;k=g[j];j++){k.step_number=j;b.drawPolyline({path:k.path,strokeColor:c.strokeColor,strokeOpacity:c.strokeOpacity,strokeWeight:c.strokeWeight});c.step(k,(h.legs[0].steps.length-1))}}}if(l.length>0&&c.end){c.end(l[l.length-1])}}})}else{if(c.route){if(c.route.legs.length>0){var a=c.route.legs[0].steps;for(var d=0,f;f=a[d];d++){f.step_number=d;b.drawPolyline({path:f.path,strokeColor:c.strokeColor,strokeOpacity:c.strokeOpacity,strokeWeight:c.strokeWeight});c.step(f)}}}}};GMaps.Route=function(a){this.origin=a.origin;this.destination=a.destination;this.waypoints=a.waypoints;this.map=a.map;this.route=a.route;this.step_count=0;this.steps=this.route.legs[0].steps;this.steps_length=this.steps.length;this.polyline=this.map.drawPolyline({path:new google.maps.MVCArray(),strokeColor:a.strokeColor,strokeOpacity:a.strokeOpacity,strokeWeight:a.strokeWeight}).getPath()};GMaps.Route.prototype.getRoute=function(b){var a=this;this.map.getRoutes({origin:this.origin,destination:this.destination,travelMode:b.travelMode,waypoints:this.waypoints||[],callback:function(){a.route=e[0];if(b.callback){b.callback.call(a)}}})};GMaps.Route.prototype.back=function(){if(this.step_count>0){this.step_count--;var b=this.route.legs[0].steps[this.step_count].path;for(var a in b){if(b.hasOwnProperty(a)){this.polyline.pop()}}}};GMaps.Route.prototype.forward=function(){if(this.step_count<this.steps_length){var b=this.route.legs[0].steps[this.step_count].path;for(var a in b){if(b.hasOwnProperty(a)){this.polyline.push(b[a])}}this.step_count++}};