if(window.google==undefined&&window.google.maps==undefined){throw"Google Maps API is required. Please register the following JavaScript library http://maps.google.com/maps/api/js?sensor=true."}var extend_object=function(b,c){var a;if(b===c){return b}for(a in c){b[a]=c[a]}return b};var replace_object=function(c,b){var a;if(c===b){return c}for(a in b){if(c[a]!=undefined){c[a]=b[a]}}return c};var array_map=function(f,e){var b=Array.prototype.slice.call(arguments,2),d=[],a=f.length,c;if(Array.prototype.map&&f.map===Array.prototype.map){d=Array.prototype.map.call(f,function(g){callback_params=b;callback_params.splice(0,0,g);return e.apply(this,callback_params)})}else{for(c=0;c<a;c++){callback_params=b;callback_params=callback_params.splice(0,0,f[c]);d.push(e.apply(this,callback_params))}}return d};var array_flat=function(c){var b=[],a;for(a=0;a<c.length;a++){b=b.concat(c[a])}return b};var coordsToLatLngs=function(b,c){var d=b[0],a=b[1];if(c){d=b[1];a=b[0]}return new google.maps.LatLng(d,a)};var arrayToLatLng=function(b,c){var a;for(a=0;a<b.length;a++){if(b[a].length>0&&typeof(b[a][0])!="number"){b[a]=arrayToLatLng(b[a],c)}else{b[a]=coordsToLatLngs(b[a],c)}}return b};var getElementById=function(c,b){var a,c=c.replace("#","");if("jQuery" in this&&b){a=$("#"+c,b)[0]}else{a=document.getElementById(c)}return a};var findAbsolutePosition=function(b){var c=0,a=0;if(b.offsetParent){do{c+=b.offsetLeft;a+=b.offsetTop}while(b=b.offsetParent)}return[c,a]};var GMaps=(function(b){var c=document;var a=function(j){j.zoom=j.zoom||15;j.mapType=j.mapType||"roadmap";var y=this,A,l=["bounds_changed","center_changed","click","dblclick","drag","dragend","dragstart","idle","maptypeid_changed","projection_changed","resize","tilesloaded","zoom_changed"],p=["mousemove","mouseout","mouseover"],r=["el","lat","lng","mapType","width","height","markerClusterer","enableNewStyle"],B=j.el||j.div,n=j.markerClusterer,C=google.maps.MapTypeId[j.mapType.toUpperCase()],w=new google.maps.LatLng(j.lat,j.lng),G=j.zoomControl||true,e=j.zoomControlOpt||{style:"DEFAULT",position:"TOP_LEFT"},z=e.style||"DEFAULT",f=e.position||"TOP_LEFT",s=j.panControl||true,m=j.mapTypeControl||true,q=j.scaleControl||true,o=j.streetViewControl||true,k=k||true,x={},u={zoom:this.zoom,center:w,mapTypeId:C},d={panControl:s,zoomControl:G,zoomControlOptions:{style:google.maps.ZoomControlStyle[z],position:google.maps.ControlPosition[f]},mapTypeControl:m,scaleControl:q,streetViewControl:o,overviewMapControl:k};if(typeof(j.el)==="string"||typeof(j.div)==="string"){this.el=getElementById(B,j.context)}else{this.el=B}if(typeof(this.el)==="undefined"||this.el===null){throw"No element defined."}window.context_menu=window.context_menu||{};window.context_menu[y.el.id]={};this.controls=[];this.overlays=[];this.layers=[];this.singleLayers={};this.markers=[];this.polylines=[];this.routes=[];this.polygons=[];this.infoWindow=null;this.overlay_el=null;this.zoom=j.zoom;this.registered_events={};this.el.style.width=j.width||this.el.scrollWidth||this.el.offsetWidth;this.el.style.height=j.height||this.el.scrollHeight||this.el.offsetHeight;google.maps.visualRefresh=j.enableNewStyle;for(A=0;A<r.length;A++){delete j[r[A]]}if(j.disableDefaultUI!=true){u=extend_object(u,d)}x=extend_object(u,j);for(A=0;A<l.length;A++){delete x[l[A]]}for(A=0;A<p.length;A++){delete x[p[A]]}this.map=new google.maps.Map(this.el,x);if(n){this.markerClusterer=n.apply(this,[this.map])}var t=function(L,Q){var P="",U=window.context_menu[y.el.id][L];for(var M in U){if(U.hasOwnProperty(M)){var O=U[M];P+='<li><a id="'+L+"_"+M+'" href="#">'+O.title+"</a></li>"}}if(!getElementById("gmaps_context_menu")){return}var R=getElementById("gmaps_context_menu");R.innerHTML=P;var H=R.getElementsByTagName("a"),T=H.length;M;for(M=0;M<T;M++){var J=H[M];var K=function(i){i.preventDefault();U[this.id.replace(L+"_","")].action.apply(y,[Q]);y.hideContextMenu()};google.maps.event.clearListeners(J,"click");google.maps.event.addDomListenerOnce(J,"click",K,false)}var N=findAbsolutePosition.apply(this,[y.el]),I=N[0]+Q.pixel.x-15,S=N[1]+Q.pixel.y-15;R.style.left=I+"px";R.style.top=S+"px";R.style.display="block"};var E=function(I,H){if(I==="marker"){H.pixel={};var i=new google.maps.OverlayView();i.setMap(y.map);i.draw=function(){var K=i.getProjection(),J=H.marker.getPosition();H.pixel=K.fromLatLngToContainerPixel(J);t(I,H)}}else{t(I,H)}};this.setContextMenu=function(H){window.context_menu[y.el.id][H.control]={};var J,I=c.createElement("ul");for(J in H.options){if(H.options.hasOwnProperty(J)){var K=H.options[J];window.context_menu[y.el.id][H.control][K.name]={title:K.title,action:K.action}}}I.id="gmaps_context_menu";I.style.display="none";I.style.position="absolute";I.style.minWidth="100px";I.style.background="white";I.style.listStyle="none";I.style.padding="8px";I.style.boxShadow="2px 2px 6px #ccc";c.body.appendChild(I);var L=getElementById("gmaps_context_menu");google.maps.event.addDomListener(L,"mouseout",function(i){if(!i.relatedTarget||!this.contains(i.relatedTarget)){window.setTimeout(function(){L.style.display="none"},400)}},false)};this.hideContextMenu=function(){var i=getElementById("gmaps_context_menu");if(i){i.style.display="none"}};var v=function(H,i){google.maps.event.addListener(H,i,function(I){if(I==undefined){I=this}j[i].apply(this,[I]);y.hideContextMenu()})};for(var D=0;D<l.length;D++){var F=l[D];if(F in j){v(this.map,F)}}for(var D=0;D<p.length;D++){var F=p[D];if(F in j){v(this.map,F)}}google.maps.event.addListener(this.map,"rightclick",function(i){if(j.rightclick){j.rightclick.apply(this,[i])}if(window.context_menu[y.el.id]["map"]!=undefined){E("map",i)}});this.refresh=function(){google.maps.event.trigger(this.map,"resize")};this.fitZoom=function(){var J=[],H=this.markers.length,I;for(I=0;I<H;I++){J.push(this.markers[I].getPosition())}this.fitLatLngBounds(J)};this.fitLatLngBounds=function(K){var J=K.length;var I=new google.maps.LatLngBounds();for(var H=0;H<J;H++){I.extend(K[H])}this.map.fitBounds(I)};this.setCenter=function(H,i,I){this.map.panTo(new google.maps.LatLng(H,i));if(I){I()}};this.getElement=function(){return this.el};this.zoomIn=function(i){i=i||1;this.zoom=this.map.getZoom()+i;this.map.setZoom(this.zoom)};this.zoomOut=function(i){i=i||1;this.zoom=this.map.getZoom()-i;this.map.setZoom(this.zoom)};var h=[],g;for(g in this.map){if(typeof(this.map[g])=="function"&&!this[g]){h.push(g)}}for(A=0;A<h.length;A++){(function(i,I,H){i[H]=function(){return I[H].apply(I,arguments)}})(this,this.map,h[A])}};return a})(this);