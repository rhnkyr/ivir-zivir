describe("Creating a map",function(){var d,c,a,b;it("should throw an error if element is not defined",function(){expect(function(){new GMaps({})}).toThrow(new Error("No element defined."))});describe("With basic options",function(){beforeEach(function(){d=d||new GMaps({el:"#basic-map",lat:-12.0433,lng:-77.0283,zoom:12})});it("should create a GMaps object",function(){expect(d).toBeDefined()});it("should have centered the map at the initial coordinates",function(){var f=d.getCenter().lat();var e=d.getCenter().lng();expect(f).toEqual(-12.0433);expect(e).toEqual(-77.0283)});it("should have the correct zoom",function(){expect(d.getZoom()).toEqual(12)})});describe("With advanced controls",function(){beforeEach(function(){c=c||new GMaps({el:"#advanced-map",lat:-12.0433,lng:-77.0283,zoomControl:true,panControl:false,streetViewControl:false,mapTypeControl:false,overviewMapControl:false})});it("should show the defined controls",function(){expect(c.map.zoomControl).toBeTruthy();expect(c.map.panControl).toBeFalsy();expect(c.map.streetViewControl).toBeFalsy();expect(c.map.mapTypeControl).toBeFalsy();expect(c.map.overviewMapControl).toBeFalsy()})});describe("With events",function(){var e,g=0,f=null;beforeEach(function(){e={onclick:function(j){var i=j.latLng.lat();var h=j.latLng.lng();a.addMarker({lat:i,lng:h,title:"New Marker"})},onzoomchanged:function(){console.log("onzoomchanged");g=this.getZoom()},oncenterchanged:function(){console.log("oncenterchanged");f=this.getCenter()}};spyOn(e,"onclick").andCallThrough();spyOn(e,"onzoomchanged").andCallThrough();spyOn(e,"oncenterchanged").andCallThrough();a=a||new GMaps({el:"#map-with-events",lat:-12.0433,lng:-77.0283,click:e.onclick,zoom_changed:e.onzoomchanged,center_changed:e.oncenterchanged})});it("should respond to zoom_changed event",function(){a.map.setZoom(16);expect(e.onzoomchanged).toHaveBeenCalled();expect(g).toEqual(16)});it("should respond to center_changed event",function(){a.map.setCenter(new google.maps.LatLng(-12.0907,-77.0227));var i=parseFloat(f.lat().toFixed(4));var h=parseFloat(f.lng().toFixed(4));expect(e.oncenterchanged).toHaveBeenCalled();expect(i).toEqual(-12.0907);expect(h).toEqual(-77.0227)});it("should respond to click event",function(){google.maps.event.trigger(a.map,"click",{latLng:new google.maps.LatLng(-12.0433,-77.0283)});expect(e.onclick).toHaveBeenCalled();expect(a.markers.length).toEqual(1)});afterEach(function(){document.getElementById("map-with-events").innerHTML="";a=null})});describe("With custom controls",function(){var f,e=0;beforeEach(function(){f={onclick:function(){b.addMarker({lat:b.getCenter().lat(),lng:b.getCenter().lng()})}};spyOn(f,"onclick").andCallThrough();b=new GMaps({el:"#map-with-custom-controls",lat:-12.0433,lng:-77.0283});b.addControl({position:"top_right",content:"Add marker at the center",style:{margin:"5px",padding:"1px 6px",border:"solid 1px #717B87",background:"#fff"},events:{click:f.onclick}})});it("should add the control to the controls collection",function(){expect(b.controls.length).toEqual(1)});it("should respond to click event attached to the custom control",function(){google.maps.event.trigger(b.controls[0],"click");expect(f.onclick).toHaveBeenCalled();expect(b.markers.length).toEqual(1)})})});