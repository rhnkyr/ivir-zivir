describe("Creating event listeners",function(){var n,e,o,i,l,g;var c,d,j;var a,m,h,f,k,b;beforeEach(function(){n=n||new GMaps({el:"#events",lat:-12.0433,lng:-77.0283,zoom:12});e=e||n.addMarker({lat:-12.0433,lng:-77.0283,title:"New marker"});o=o||n.drawPolyline({path:[[-12.044,-77.0247],[-12.0544,-77.0302],[-12.0551,-77.0303],[-12.0759,-77.0276],[-12.0763,-77.0279],[-12.0768,-77.0289],[-12.0885,-77.0241],[-12.0908,-77.0227]],strokeColor:"#131540",strokeOpacity:0.6,strokeWeight:6});i=i||n.drawPolygon({paths:[[-12.0403,-77.0337],[-12.0402,-77.0399],[-12.05,-77.0244],[-12.0448,-77.0215]],strokeColor:"#25D359",strokeOpacity:1,strokeWeight:3,fillColor:"#25D359",fillOpacity:0.6})});describe("for google.maps events",function(){beforeEach(function(){l=l||{map:{onclick:function(){console.log("callbacks_native.map.onclick")}},marker:{onclick:function(){console.log("callbacks_native.marker.onclick")}},line:{onclick:function(){console.log("callbacks_native.line.onclick")}},polygon:{onclick:function(){console.log("callbacks_native.polygon.onclick")}}};spyOn(l.map,"onclick").andCallThrough();spyOn(l.marker,"onclick").andCallThrough();spyOn(l.line,"onclick").andCallThrough();spyOn(l.polygon,"onclick").andCallThrough()});describe("To a map",function(){it("should add the listener to the listeners collection",function(){var p=GMaps.on("click",n.map,l.map.onclick);expect(n.map.__e3_["click"][p.id]).toBeDefined();expect(n.map.__e3_["click"][p.id]).toEqual(p)})});describe("To a marker",function(){it("should add the listener to the listeners collection",function(){var p=GMaps.on("click",e,l.marker.onclick);expect(e.__e3_["click"][p.id]).toBeDefined();expect(e.__e3_["click"][p.id]).toEqual(p)})});describe("To a line",function(){it("should add the listener to the listeners collection",function(){var p=GMaps.on("click",o,l.line.onclick);expect(o.__e3_["click"][p.id]).toBeDefined();expect(o.__e3_["click"][p.id]).toEqual(p)})});describe("To a polygon",function(){it("should add the listener to the listeners collection",function(){var p=GMaps.on("click",i,l.polygon.onclick);expect(i.__e3_["click"][p.id]).toBeDefined();expect(i.__e3_["click"][p.id]).toEqual(p)})})});describe("for GMaps events",function(){beforeEach(function(){g={marker_added:function(){console.log("callbacks_gmaps.marker_added called")},marker_removed:function(){console.log("callbacks_gmaps.marker_removed called")},polyline_added:function(){console.log("callbacks_gmaps.polyline_added called")},polyline_removed:function(){console.log("callbacks_gmaps.polyline_removed called")},polygon_added:function(){console.log("callbacks_gmaps.polygon_added called")},polygon_removed:function(){console.log("callbacks_gmaps.polygon_removed called")}};spyOn(g,"marker_added").andCallThrough();spyOn(g,"marker_removed").andCallThrough();spyOn(g,"polyline_added").andCallThrough();spyOn(g,"polyline_removed").andCallThrough();spyOn(g,"polygon_added").andCallThrough();spyOn(g,"polygon_removed").andCallThrough()});describe("#marker_added",function(){beforeEach(function(){a=GMaps.on("marker_added",n,g.marker_added)});it("should add the listener to the listeners collection",function(){expect(n.registered_events.marker_added[0]).toEqual(a)});it("should trigger the listener created",function(){c=c||n.addMarker({lat:-12.0433,lng:-77.0273,title:"New marker"});expect(g.marker_added).toHaveBeenCalled()});afterEach(function(){GMaps.off("marker_added",n)})});describe("#marker_removed",function(){beforeEach(function(){m=GMaps.on("marker_removed",n,g.marker_removed)});it("should add the listener to the listeners collection",function(){expect(n.registered_events.marker_removed[0]).toEqual(m)});it("should trigger the listener created",function(){n.removeMarker(c);expect(g.marker_removed).toHaveBeenCalled()});afterEach(function(){GMaps.off("marker_removed",n)})});describe("#polyline_added",function(){beforeEach(function(){h=GMaps.on("polyline_added",n,g.polyline_added)});it("should add the listener to the listeners collection",function(){expect(n.registered_events.polyline_added[0]).toEqual(h)});it("should trigger the listener created",function(){d=d||n.drawPolyline({path:[[-12.042,-77.0247],[-12.0544,-77.0102],[-12.0751,-77.0903],[-12.0759,-77.0276],[-12.0763,-77.0279],[-12.0768,-77.0289],[-12.0885,-77.0241],[-12.0908,-77.0227]],strokeColor:"#271804",strokeOpacity:0.1,strokeWeight:1});expect(g.polyline_added).toHaveBeenCalled()});afterEach(function(){GMaps.off("polyline_added",n)})});describe("#polyline_removed",function(){beforeEach(function(){f=GMaps.on("polyline_removed",n,g.polyline_removed)});it("should add the listener to the listeners collection",function(){expect(n.registered_events.polyline_removed[0]).toEqual(f)});it("should trigger the listener created",function(){n.removePolyline(d);expect(g.polyline_removed).toHaveBeenCalled()});afterEach(function(){GMaps.off("polyline_removed",n)})});describe("#polygon_added",function(){beforeEach(function(){k=GMaps.on("polygon_added",n,g.polygon_added)});it("should add the listener to the listeners collection",function(){expect(n.registered_events.polygon_added[0]).toEqual(k)});it("should trigger the listener created",function(){j=j||n.drawPolygon({paths:[[-12.0203,-77.0137],[-12.0402,-77.0109],[-12.05,-77.0144],[-12.0848,-77.0115]],strokeColor:"#D32559",strokeOpacity:0.7,strokeWeight:8,fillColor:"#D32559",fillOpacity:0.6});expect(g.polygon_added).toHaveBeenCalled()});afterEach(function(){GMaps.off("polygon_added",n)})});describe("#polygon_removed",function(){beforeEach(function(){b=GMaps.on("polygon_removed",n,g.polygon_removed)});it("should add the listener to the listeners collection",function(){expect(n.registered_events.polygon_removed[0]).toEqual(b)});it("should trigger the listener created",function(){n.removePolygon(j);expect(g.polygon_removed).toHaveBeenCalled()});afterEach(function(){GMaps.off("polygon_removed",n)})})})});